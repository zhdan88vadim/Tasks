<!-- <div class="alert alert-success" role="alert">
	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	<strong>Update was successfull!</strong>
</div> -->


<alert ng-repeat="alert in alerts" type="{{alert.type}}" 
	close="closeAlert($index)"><div ng-bind-html="MessageBox"></div>
</alert>

<div class="form-group">
	<input ng-model="searchText" class="form-control search-text" type="text" placeholder="Enter text to filter persons">
</div>
<table class="table table-striped">
	<thead>
		<tr>
			<th class="col-sm-2">
				<a ng-click="order('firstName')" href="">First Name</a>
				<span class="sortorder" ng-show="predicate === 'firstName'" ng-class="{reverse:reverse}"></span>
			</th>
			<th class="col-sm-2">
				<a ng-click="order('lastname')" href="">Last Name</a>
				<span class="sortorder" ng-show="predicate === 'lastname'" ng-class="{reverse:reverse}"></span>
			</th>
			<th class="col-sm-2">
				<a ng-click="order('age')" href="">Age</a>
				<span class="sortorder" ng-show="predicate === 'age'" ng-class="{reverse:reverse}"></span>
			</th>
			<th class="col-sm-2">
				<a ng-click="order('address.city')" href="">City</a>
				<span class="sortorder" ng-show="predicate === 'address.city'" ng-class="{reverse:reverse}"></span>
			</th>
			<th class="col-sm-4"><select ng-model="selectPhoneType" ng-options="type.label for type in phoneTypes" class="form-control"></select></th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="person in persons 
		| personFilter:searchText:selectPhoneType 
		| orderBy:predicate:reverse">
		<td><a href="#/person/{{ person.id }}">{{ person.firstName }}</a></td>
		<td>{{ person.lastName }}</td>
		<td>{{ person.age }}</td>
		<td>{{ person.address.city }}</td>
		<td>{{ person.phoneNumber | phoneNumber:selectPhoneType }}</td>
		<td>
			<button ng-click="editPerson(person, $event)" type="button" class="btn btn-default">
				<span class="glyphicon glyphicon-pencil" aria-hidden="true">
				</span>
			</button>
		</td>
	</tr>
</tbody>
</table>

<button ng-click="addPerson()" type="button" class="btn btn-primary">
	<i class="glyphicon glyphicon-plus"></i>
	Add New Person
</button>

<custom-modal
header="some custom string or <b>HTML</b> header" 
show="showModal" 
ok-text="Submit" 
cancel-text="Close window" 
oncancel="" 
onsubmit="update()">


<form name="form" class="person-form" role="form" novalidate event-submit>

<div class="row">

	<div class="col-md-12">
		<div class="separator"></div>
		<div class="col-md-6 no-lpad">
			<div class="form-group" ng-class="{'has-error': form.$submitted && form.age.$invalid}">
				<label>Age *</label>
				<input 
				ng-model="selectPerson.age" 
				ng-value="selectPerson.age" 
				ng-min="1"
				ng-max="199"
				ng-required="true"
				name="age" 
				type="number" 
				class="form-control" 
				id="age">
			</input>
				<div ng-show="form.$submitted">
					<small ng-show="form.age.$error.required" class="help-block error">Age is required.</small>
					<small ng-show="form.age.$error.min || form.age.$error.ngMin" class="help-block error">Age should be more than 0.</small>
					<small ng-show="form.age.$error.max" class="help-block error">Unfortunately 199 years is our current system limit. Please contact Laws of Nature in case of questions.</small>
				</div>
			</div>
			<div class="form-group">
				<label>Street</label>
				<input 
				ng-model="selectPerson.address.streetAddress" 
				ng-value="selectPerson.address.streetAddress" 
				name="streetAddress"
				type="text"
				class="form-control"
				id="street"></input>
			</div>
			<div class="form-group" ng-class="{'has-error': form.$submitted && form.city.$invalid}">
				<label>City *</label>
				<input 
				ng-model="selectPerson.address.city" 
				ng-value="selectPerson.address.city" 
				type="text"
				name="city"
				ng-minlength="3"
				ng-maxlength="50"
				ng-required="true"
				class="form-control" 
				id="city"></input>
				<div ng-show="form.$submitted">
					<small ng-show="form.city.$error.required" class="help-block error">City is required.</small>
					<small ng-show="form.city.$error.minlength" class="help-block error">City name should be more than 2 characters.</small>
					<small ng-show="form.city.$error.maxlength" class="help-block error">City name should be less than 50 characters.</small>
				</div>
			</div>
			<div class="form-group">
				<label>State</label>
				<input 
				ng-model="selectPerson.address.state" 
				ng-value="selectPerson.address.state" 
				type="text" 
				class="form-control" 
				id="state"></input>
			</div>
		</div>

		<div class="col-md-6 no-rpad">
			<div class="form-group">
				<label>Postal Code</label>
				<input 
				ng-model="selectPerson.address.postalCode" 
				ng-value="selectPerson.address.postalCode" 
				type="text" 
				class="form-control" 
				id="postalCode"></input>
			</div>

			<div class="form-group" ng-class="{'has-error': form.$submitted && form.homePhone.$invalid}">
				<label>Home Number *</label>
				<phone ng-model="personHomePhone" name="homePhone" form="form"></phone>
			</div>
			<div class="form-group" ng-class="{'has-error': form.$submitted && form.faxPhone.$invalid}">
				<label>Fax Number *</label>
				<phone ng-model="personFaxPhone" name="faxPhone" form="form"></phone>
			</div>
		</div>

		<div class="separator"></div>

		<div class="form-group text-right">
			<button ng-click="back()" type="button" class="btn btn-default">Cancel</button>
			<button 
			ng-click="form.$valid && personUpdate()"
			ng-disabled="form.$pristine"
			type="submit"
			class="btn btn-primary">Update</button>
			
			<!-- form.$pristine || form.$invalid -->

			<div 
			ng-show="form.$submitted" 
			ng-class="{'has-error': !form.$valid}"
			class="summary-error"
			>
				<small ng-show="!form.$valid" class="help-block"> Please correct errors in the form above.</small>
			</div>
			<!-- ng-click="update()" -->
		</div>
	</div>
</form>

</custom-modal>